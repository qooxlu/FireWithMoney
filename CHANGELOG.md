# FireWithMoney 更新日志

## v2.1 - 提示优化 (2025-11-22)

### 🔧 改进

#### 自定义提示显示时长
- 创建 `PopTextWithDuration` 扩展方法
- 解决原版 `PopText` 所有消息只显示2秒的限制
- 根据消息重要性调整显示时长：
  - **仓库转移**: 2.5秒
  - **购买成功**: 2秒
  - **支付模式切换**: 2秒
  - **部分购买警告**: 3秒
  - **余额不足错误**: 4秒（更长时间阅读）

#### 技术实现
- 使用反射访问游戏内部 API
- 直接调用 `DialogueBubblesManager.Show` 方法
- 支持自定义 `duration` 参数

---

## v2.0 - 仓库支持 (2025-11-22)

### 🆕 新增功能

#### 智能子弹获取系统
装弹时按以下优先级自动获取子弹：

```
1. 背包 (免费) 
   ↓ 不足
2. 仓库 (免费转移)
   ↓ 不足  
3. 购买 (花钱)
   - 银行卡支付
   - 现金支付
```

#### 仓库管理器
- 自动检测仓库中的子弹库存
- 智能转移子弹到背包
- 支持部分转移和完整堆叠

### 🔧 架构改进

重构为模块化架构：
- `Config/` - 配置文件
- `Models/` - 数据模型
- `Managers/` - 业务逻辑
  - MoneyManager - 资金管理
  - BulletManager - 子弹管理
  - WarehouseManager - 仓库管理 🆕
- `Patch/` - 游戏补丁
- `Main/` - 主入口

### 📋 使用说明

1. **切换支付模式**: 按 `Shift+B`
2. **装弹优先级**:
   - 优先使用背包现有子弹（免费）
   - 背包不足自动从仓库转移（免费）
   - 仓库也不足则购买（花钱）

3. **提示信息**:
   - `从仓库转移 X 发子弹` - 从仓库成功转移
   - `银行卡/现金 -X 元` - 购买子弹成功
   - `余额不足！还需要 X 元` - 钱不够

### 💡 优势

- ✅ 节省金钱：优先使用免费资源（背包和仓库）
- ✅ 自动化：无需手动从仓库取子弹
- ✅ 智能提示：清楚知道子弹来源
- ✅ 容错处理：操作失败自动回滚

---

## v1.0 - 初始版本

### 基础功能
- 装弹时自动购买子弹
- 银行卡/现金双支付模式
- 显示所有可用子弹类型
- 子弹按等级排序
